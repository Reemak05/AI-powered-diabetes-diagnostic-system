<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Diabetes Analytics</title>
     <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <style>
          body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            background: #f4f6f9;
            color: #333;
        }

        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2c3e50;
            padding: 15px 50px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        #header img.logo {
            height: 60px;
        }

        #navbar {
            display: flex;
            gap: 20px;
        }

        #navbar li {
            list-style: none;
        }

        #navbar li a {
            text-decoration: none;
            color: #ecf0f1;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        #navbar li a:hover,
        #navbar li a.active {
            color: #1abc9c;
        }

        canvas {
            max-width: 600px;
            margin: auto;
        }
        .summary { font-size: 1.2rem; margin-bottom: 30px; }
      .chart-container { width: 80%; margin-bottom: 50px; }
      h1 {
  text-align: center;
  margin-top: 50px;
  margin-bottom: 50px;
  font-size: 3rem;
  font-weight: 700;
  background: linear-gradient(270deg, #1abc9c, #3498db, #9b59b6, #e67e22);
  background-size: 800% 800%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: gradientAnimation 10s ease infinite;
}

@keyframes gradientAnimation {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}


      /* Hide the hamburger by default */

#menu-toggle {
  display: none;
  font-size: 28px;
  background: none;
  border: none;
  color: #ecf0f1;
  cursor: pointer;
}
/* Grid container for charts */
.charts-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 40px;
  max-width: 1200px;
  margin: 0 auto 60px;
  padding: 0 20px;
}

.chart-container {
  background: #fff;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.07);
  /* Smaller height for better fit */
  height: 350px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.chart-container h2 {
  margin-bottom: 15px;
  font-weight: 600;
  font-size: 1.2rem;
  color: #2c3e50;
  text-align: center;
}

/* Make canvas fill container nicely */
.chart-container canvas {
  max-width: 100%;
  height: 250px !important;
  margin: 0 auto;
}
.chart-container h3 {
  margin-bottom: 15px;
  font-weight: 600;
  color: #2c3e50;
  font-size: 1.2rem;
  text-align: center;
}


/* Responsive styles */
@media (max-width: 768px) {
  #header {
    flex-wrap: wrap;
    padding: 15px 20px;
  }

  /* Show hamburger button */
  #menu-toggle {
    display: block;
  }

  /* Hide the navbar initially */
  #navbar {
    width: 100%;
    display: none;
    flex-direction: column;
    margin-top: 10px;
    padding-left: 0;
  }

  /* Navbar items displayed vertically */
  #navbar li {
    text-align: center;
    margin: 10px 0;
  }

  /* Show navbar when active */
  #navbar.active {
    display: flex;
  }
  .charts-grid {
    grid-template-columns: 1fr;
    gap: 30px;
  }
  .chart-container {
    height: auto;
  }
  .chart-container canvas {
    height: 300px !important;
  }
}

    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <section id="header">
  <a href="#"><img src="{{ url_for('static', filename='img/logo.png') }}" alt="logo" width="90" height="80"></a>

  <!-- Hamburger menu button for small screens -->
  <button id="menu-toggle" aria-label="Toggle Menu">&#9776;</button>

  <ul id="navbar">
        <li><a href="{{ url_for('manage_user') }}">Manage User</a></li>
        <li><a class="active"  href="{{ url_for('analytics') }}">Analytics</a></li>
        <li><a href="{{ url_for('admin_settings') }}">Settings</a></li>
        <li><a href="{{ url_for('admin_profile') }}"><i class="fa fa-user"></i></a></li>
    </ul>
</section>
    <h1>Admin Analytics Dashboard</h1>



<div class="charts-grid">
    <div class="chart-container">
        <h3>Total Users on Website: <strong>{{ total_users }}</strong></h3>
        <canvas id="totalUsersChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>Diabetes vs Non-Diabetes Users</h2>
        <canvas id="pieChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>Number of Predictions in Last 30 Days</h2>
        <canvas id="lineChartPredictions"></canvas>
    </div>

    <div class="chart-container">
        <h2>Average Health Metrics in Last 30 Days</h2>
        <canvas id="lineChartMetrics"></canvas>
    </div>
</div>


    <script>
        document.getElementById('menu-toggle').addEventListener('click', () => {
  const navbar = document.getElementById('navbar');
  navbar.classList.toggle('active');
});

        const ctx = document.getElementById('totalUsersChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Users'],
                datasets: [{
                    label: 'Total Users',
                    data: [{{ total_users }}],
                    backgroundColor: ['#4CAF50']
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                },
                responsive: true,
                plugins: {
                    legend: { display: false }
                }
            }
        });
        // Pie Chart Data
        const pieCtx = document.getElementById('pieChart').getContext('2d');
        const pieChart = new Chart(pieCtx, {
            type: 'pie',
            data: {
                labels: ['Diabetic', 'Non-Diabetic'],
                datasets: [{
                    label: 'Users',
                    data: [{{ diabetic_count }}, {{ non_diabetic_count }}],
                    backgroundColor: ['#FF6384', '#36A2EB'],
                }]
            },
            options: {
                responsive: true,
            }
        });

        // Line Chart Predictions
        const linePredCtx = document.getElementById('lineChartPredictions').getContext('2d');
        const lineChartPredictions = new Chart(linePredCtx, {
            type: 'line',
            data: {
                labels: {{ dates | tojson }},
                datasets: [{
                    label: 'Predictions Count',
                    data: {{ prediction_counts | tojson }},
                    fill: false,
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1
                }]
            },
            options: { responsive: true }
        });

        // Line Chart Health Metrics
        const lineMetricsCtx = document.getElementById('lineChartMetrics').getContext('2d');
        const lineChartMetrics = new Chart(lineMetricsCtx, {
            type: 'line',
            data: {
                labels: {{ metric_dates | tojson }},
                datasets: [
                    {
                        label: 'Average Glucose',
                        data: {{ avg_glucose | tojson }},
                        borderColor: 'rgba(255, 99, 132, 1)',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Average BMI',
                        data: {{ avg_bmi | tojson }},
                        borderColor: 'rgba(54, 162, 235, 1)',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Average Blood Pressure',
                        data: {{ avg_bp | tojson }},
                        borderColor: 'rgba(255, 206, 86, 1)',
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: { responsive: true }
        });
    </script>
</body>
</html>